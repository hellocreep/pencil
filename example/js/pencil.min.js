!function(a){function b(a,c){var d=b.DEFAULTS;for(var e in c)d[e]=c[e];this.opts=d;var f=a||"canvas",g=document.getElementById(f),a=g.getContext("2d");this.el=g,this.paper=a,this.started=!1,this.trace=[],this.brush={},this.init()}b.prototype.init=function(){var a=this;this.set("original");var b,c=["touchstart","touchmove","touchend"],d=["mousedown","mousemove","mouseup"];"ontouchstart"in window?(b=c,a.isTouch=!0):(b=d,a.isTouch=!1),this.el.addEventListener(b[0],function(b){a.start(b)},!1),this.el.addEventListener(b[1],function(b){b.preventDefault(),a.draw(b)},!1),this.el.addEventListener(b[2],function(b){a.stop(b)},!1)},b.prototype.start=function(a){this.started=!0,this.paper.beginPath();var b=this.isTouch?a.touches[0].pageX:a.offsetX,c=this.isTouch?a.touches[0].pageY:a.offsetY;this.paper.moveTo(b,c)},b.prototype.stop=function(){this.started=!1,this.trace.push(this.brush),this.trace.push("stop"),this.paper.closePath()},b.prototype.draw=function(a){if(this.started){var b=this.isTouch?a.touches[0].pageX:a.offsetX,c=this.isTouch?a.touches[0].pageY:a.offsetY;this.trace.push({x:b,y:c}),this.paper.lineTo(b,c),this.paper.stroke()}},b.prototype.clear=function(){this.paper.clearRect(0,0,this.paper.canvas.width,this.paper.canvas.height)},b.prototype._draw=function(){var a=this,b=0,c=a.trace,d=c.length,e=c[c.indexOf("stop")-1];for(var f in e)this.paper[f]=e[f];this.paper.beginPath();var g=function(){var e=c[b];return"stop"===e?(a.paper.closePath(),cancelAnimationFrame(g),a.trace=c.splice(b+1),void a._draw()):b>=d?void cancelAnimationFrame(g):(a.paper.lineTo(e.x,e.y),a.paper.stroke(),b++,void requestAnimationFrame(g))};requestAnimationFrame(g)},b.prototype.play=function(){this.clear(),this._draw()},b.prototype.add=function(a){for(var b in a){if(this.opts.brush.hasOwnProperty(b))return void console.log(b+" has allready exit, use another name.");this.opts.brush[b]=a[b]}},b.prototype.set=function(a){var b=this.opts.brush[a];if(b){for(var c in b)this.paper[c]=b[c];this.brush=b}},b.DEFAULTS={paper:"canvas",brush:{original:{strokeStyle:"#333",lineCap:"round",lineWidth:2},thin:{strokeStyle:"#333",lineCap:"round",lineWidth:1},fat:{strokeStyle:"#333",lineCap:"round",lineWidth:10}}},a.Pencil=b}(window);